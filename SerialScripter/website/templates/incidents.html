{%- extends "base.html" %}
<body>
  {% block content %}
  <div class="row justify-content-between align-items-right">
    <div class="col-lg-auto"></div>
    <div class="col-lg-auto"></div>
    <div class="col-lg-auto"></div>
  </div>

  <script>
    function autoType() {
      document.getElementById('search-box').focus();
    }
    window.onload = autoType;
  </script>
  <div class="container">
    <div class="col-lg-12">
      <div class="page-header">
        <h1 class="header-font-xxl">Incidents</h1>
      </div>
    </div>
  </div>
  <div class="container">
    <form action="/incidents">
      <input
        id="search-box"
        name="search"
        class="search-container"
        type="text"
        placeholder="Search.."
      />
    </form>
    <table class="table table-box">
      <thead>
        <tr>
          <!-- <td>ðŸ‘¾ <a href="/host-69" class="column-hotpink" style="text-decoration:none"> host-69</a></td> -->
          <th scope="column-hotpink" scope="col">
            <a class="column-hotpink" href="/incidents?filter=hosts">IP</a>
          </th>
          <th class="column-hotpink" scope="col">
            <a class="column-hotpink" href="/incidents?filter=users">User</a>
          </th>
          <th class="column-hotpink" scope="col">
            <a class="column-hotpink" href="/incidents?filter=processes"
              >Name</a
            >
          </th>
          <th class="column-hotpink" scope="col">
            <a class="column-hotpink" href="/incidents?filter=ips">Time</a>
          </th>
          <th class="column-hotpink" scope="col">
            <a class="column-hotpink" href="/incidents?filter=cmds">Severity</a>
          </th>
          <th class="column-hotpink" scope="col">
            <a class="column-hotpink" href="/incidents?filter=cmds">Payload</a>
          </th>
        </tr>
      </thead>
      <tbody>
        {% for alert in incidents %}
        <tr>
          {% for key, value in alert.items() %}
          <td>{{value.Host}}</td>
          <td>{{ value.Incident.User }}</td>
          <td>{{ value.Incident.Name }}</td>
          <td>{{ value.Incident.CurrentTime }}</td>
          <td>{{ value.Incident.Severity }}</td>
          <td>{{ value.Incident.Payload }}</td>
          {% endfor %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% endblock %}
</body>
